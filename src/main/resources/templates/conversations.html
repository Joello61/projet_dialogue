<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="fr">

<th:block th:replace="~{layout :: layout(~{::content})}">

    <th:block th:fragment="content">

        <div class="container py-4">

            <div class="d-flex justify-content-between align-items-center mb-4">
                <h2 class="fw-bold mb-0">
                    Mes conversations
                </h2>

                <a href="/user" class="btn btn-outline-secondary btn-sm">
                    <i class="bi bi-people"></i> Nouveaux contacts
                </a>
            </div>

            <div th:if="${#lists.isEmpty(conversations)}" class="text-center text-muted py-5">
                <p class="lead">
                    Vous n'avez pas encore de conversation.
                </p>
                <a href="/user" class="btn btn-primary">
                    <i class="bi bi-person-plus"></i> Trouver un utilisateur
                </a>
            </div>

            <div th:if="${!#lists.isEmpty(conversations)}" class="list-group shadow-sm">

                <div th:each="conv : ${conversations}"
                     th:with="otherUser=${conv.user1.id == currentUser.id} ? ${conv.user2} : ${conv.user1}"
                     class="list-group-item d-flex justify-content-between align-items-center py-3">

                    <!-- INFO UTILISATEUR -->
                    <div class="d-flex align-items-center gap-3">
                        <i class="bi bi-person-circle fs-3 text-primary"></i>

                        <div>
                            <div class="fw-semibold" th:text="${otherUser.username}">
                                Nom de l'autre utilisateur
                            </div>
                            <small class="text-muted">
                                Conversation #<span th:text="${conv.id}">1</span>
                            </small>
                        </div>
                    </div>

                    <!-- BOUTONS ACTIONS -->
                    <div class="d-flex gap-2">
                        <!-- Bouton Chat -->
                        <a th:href="@{'/conversation/' + ${conv.id}}"
                           class="btn btn-primary btn-sm">
                            <i class="bi bi-chat-dots"></i> Chat
                        </a>

                        <!-- Bouton Galerie -->
                        <a th:href="@{'/conversation/' + ${conv.id} + '/gallery'}"
                           class="btn btn-outline-primary btn-sm">
                            <i class="bi bi-images"></i> Galerie
                        </a>
                    </div>

                </div>

            </div>

            <div class="text-center mt-4">
                <a href="/user/home" class="btn btn-outline-secondary">
                    <i class="bi bi-house"></i> Retour Ã  l'accueil
                </a>
            </div>

        </div>

    </th:block>

</th:block>

</html>